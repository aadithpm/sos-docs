<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>Generating_Reports</title><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}
div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}

.cell-kernel-selector {
	width:70pt;
    background: none;
    z-index: 1000;
    position: absolute;
    height: 1.7em;
    margin-top: 3pt;
    right: 8pt;
    font-size: 80%;
}

textarea.sos-source {
  line-height: 1.21429em;
  font-size: 14px;
  background: none;
  width: 100%;
  border: none;
  font-family: monospace;
  height: auto;
  padding: 0.4em;
  outline: none;
  position: relative;
  resize: none;
  overflow: hidden;
  vertical-align: text-top;
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>


<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107286198-1"></script>
<script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments)};
   gtag('js', new Date());
   
   gtag('config', 'UA-107286198-1');
</script>


<meta name="viewport" content="width=device-width, initial-scale=1">




<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/codemirror.css">
  
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet">
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<style>  /* defined here in case the main.css below cannot be loaded */
   .lev1 {margin-left: 80px}
   .lev2 {margin-left: 100px}
   .lev3 {margin-left: 120px}
   .lev4 {margin-left: 140px}
   .lev5 {margin-left: 160px}
   .lev6 {margin-left: 180px}
   .cm-sos-interpolated {
  background-color: #EDD5F3;
}
.cm-sos-sigil {
  background-color: #EDD5F3;
}
</style>
<link rel="stylesheet" type="text/css" href="../../css/jt.css">
<link rel="stylesheet" type="text/css" href="../../css/toc2.css">
<script src="../../js/doc_toc.js"></script>
<script src="../../js/docs.js"></script>
<script>
   MathJax.Hub.Config({
       "HTML-CSS": {
           preferredFont: "TeX",
           availableFonts: ["STIX","TeX"],
           styles: {
               scale: 110,
               ".MathJax_Display": {
                   "font-size": "110%",
               }
           }
       }
   });
</script>
<script>
   function filterDataFrame(id) {
       var input = document.getElementById("search_" + id);
       var filter = input.value.toUpperCase();
       var table = document.getElementById("dataframe_" + id);
       var tr = table.getElementsByTagName("tr");
   
       // Loop through all table rows, and hide those who don't match the search query
       for (var i = 1; i < tr.length; i++) {
           for (var j = 0; j < tr[i].cells.length; ++j) {
               var matched = false;
               if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                   tr[i].style.display = "";
                   matched = true
                   break;
               }
               if (!matched)
                   tr[i].style.display = "none";
           } 
       }
   }
   
   function sortDataFrame(id, n, dtype) {
       var table = document.getElementById("dataframe_" + id);
   
       var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
       var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
   
       if (dtype === 'numeric') {
           var fn = function(a, b) { 
               return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
           }
       } else {
           var fn = function(a, b) {
               var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
               return c > 0 ? 1 : (c < 0 ? -1 : 0) }
       }
       var isSorted = function(array, fn) {
           if (array.length < 2)
               return 1;
           var direction = fn(array[0], array[1]); 
           for (var i = 1; i < array.length - 1; ++i) {
               var d = fn(array[i], array[i+1]);
               if (d == 0)
                   continue;
               else if (direction == 0)
                   direction = d;
               else if (direction != d)
                   return 0;
               }
           return direction;
       }
   
       var sorted = isSorted(tr, fn);
   
       if (sorted == 1 || sorted == -1) {
           // if sorted already, reverse it
           for(var i = tr.length - 1; i >= 0; --i)
               tb.appendChild(tr[i]); // append each row in order
       } else {
           tr = tr.sort(fn);
           for(var i = 0; i < tr.length; ++i)
               tb.appendChild(tr[i]); // append each row in order
       }
   }
   
   $( document ).ready(function(){
   
               var cfg={'threshold':4,     // depth of toc (number of levels)
                // 'number_sections': true,  // sections numbering
                'number_sections': false, 
                'toc_cell': false,          // useless here
                'toc_window_display': true, // display the toc window
                "toc_section_display": "block", // display toc contents in the window
                // 'sideBar':true,      
                'sideBar':true,       // sidebar or floating window
                'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
               }
   
               var st={};                  // some variables used in the script
               st.rendering_toc_cell = false;
               st.config_loaded = false;
               st.extension_initialized=false;
               st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
               st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
               st.nbcontainer_width = $('#notebook-container').css('width')
               st.oldTocHeight = undefined
               st.cell_toc = undefined;
               st.toc_index=0;
   
               // fire the main function with these parameters
   
   
   
               table_of_contents(cfg,st);
               var file=tutorialsDict[$("h1:first").attr("id")];
               var path="http://vatlab.github.io/sos-docs"
            // $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()

            var tuts=tutorials;
            var pos=tutorials.indexOf(file);

            for (var a=pos;a>=0;a--){
                  var name=tuts[a]
                  $('<li><a href="'+path+'/doc/tutorials/'+name+'.html">'+name.replace(/_/g," ")
                        + '&nbsp ' + '<i class="fa ' +
                      (a === pos ? 'fa-caret-down' : 'fa-caret-right') + '"></i>' + '</a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+path+'/doc/tutorials/'+file+'.html'+'"]').css("color","#126dce");

            for (var a=pos+1;a<tuts.length;a++){
                  var name=tuts[a]
                  $(".toc #toc-level0").append('<li><a href="'+path+'/doc/tutorials/'+name+'.html">'+name.replace(/_/g," ")
                    + '&nbsp' + '<i class="fa fa-caret-right"></i>' +'</a></li>');
            }

            // for (var a =0;a<tuts.length;a++){
            //       var name =tuts[a];
            //       if ()
            //       $(".toc #toc-level0").append('<li><a href="'+path+'/doc/tutorials/'+name+'.html">'+name.replace("_"," ")+'</a></li>');
            // }

            // $(".toc #toc-level0").append('<li id="indexHome"><a href="'+path+'/index.html"><b>Home<b></a></li>');
            // var home=$("#toc-level0 #indexHome");

            // home.insertBefore("#toc-level0 li:eq(0)");


            // $(".number_sections-btn").hide();
            // $(".toc_cell_sections-btn".hide();   
   
       });
</script><style>  /* defined here in case the main.css below cannot be loaded */
   .lan_SoS {}.lan_Bash .input_prompt { background-color: #E6EEFF !important }.lan_Julia .input_prompt { background-color: #ebd8eb !important }.lan_MATLAB .input_prompt { background-color: #dff8fb !important }.lan_Python3 .input_prompt { background-color: #FFE771 !important }.lan_R .input_prompt { background-color: #DCDCDA !important }.lan_django_extensions {}.lan_jupyter3_python_3 {}
</style>


<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Generating-Reports-using-SoS">Generating Reports using SoS<a class="anchor-link" href="#Generating-Reports-using-SoS">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are multiple ways to generate reports from the execution of SoS workflows. This tutorial introduces some basic methods but you can certainly be more creative.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-summarization-step">A summarization step<a class="anchor-link" href="#A-summarization-step">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can write a report at the end of the workflow that summarizes the results of previous steps. For example, in the following example, the <code>report</code> action summarizes previous steps and writes a report to the standard output.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_SoS">
   
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div><div class="inner_cell" style="min-height: 38.44285718em;">
  <div class="input_area cm-s-ipython">
   <textarea rows="26" class="sos-source" name="SoS">%sandbox
%run

[10]
output: 'a.jpg'
R: expand=True
    jpeg({_output:r})
    cars <- c(1, 3, 6, 4, 9)
    barplot(cars)

[20]
output: 'a.txt'
run:
    echo "100" > a.txt

[100]
input: 'a.jpg', 'a.txt'
with open('a.txt') as a:
    res = a.read()

report: expand=True
    * Figure
    ![figure](a.jpg)
    * result
    {res}
   </textarea>
  </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>echo &#34;100&#34; &gt; a.txt

* Figure
![figure](a.jpg)
* result
100

</pre>
</div>
</div>

</div>
</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is a pretty bad idea to write report to standard output because other actions can also write to it. You should therefore use the <code>output</code> option of the <code>report</code> action to specify an output file of the <code>report</code> action.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_SoS">
   
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div><div class="inner_cell" style="min-height: 45.58571433em;">
  <div class="input_area cm-s-ipython">
   <textarea rows="31" class="sos-source" name="SoS">%sandbox
%preview summary.md
%run

[10]
output: 'a.jpg'
R: expand=True
    jpeg({_output:r})
    cars <- c(1, 3, 6, 4, 9)
    barplot(cars)

[20]
output: 'a.txt'
run:
    echo "100" > a.txt

[counts: shared='counts']
input: 'a.txt'
with open('a.txt') as a:
    counts = a.read()

[100]
input: 'a.jpg'
depends: sos_variable('counts')

report: output='summary.md', expand=True
    * Figure
    ![figure](a.jpg)
    * result
    {counts}
   </textarea>
  </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>echo &#34;100&#34; &gt; a.txt

</pre>
</div>
</div>

</div>
</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Instead of outputting reports in <code>.md</code> format and rendering them outside of SoS, you can also render them inside SoS using action <code>pandoc</code> or <code>Rmarkdown</code>. For example,</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_SoS">
   
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div><div class="inner_cell" style="min-height: 41.30000004em;">
  <div class="input_area cm-s-ipython">
   <textarea rows="28" class="sos-source" name="SoS">%sandbox
%preview summary.html
[10]
output: 'a.jpg'
R: expand=True
    jpeg({_output:r})
    cars <- c(1, 3, 6, 4, 9)
    barplot(cars)

[20]
output: 'a.txt'
run:
    echo "100" > a.txt

[counts: shared='counts']
input: 'a.txt'
with open('a.txt') as a:
    counts = a.read()

[100]
input: 'a.jpg'
depends: sos_variable('counts')

pandoc: output='summary.html', expand=True
    * Figure
    ![figure](a.jpg)
    * result
    {counts}</textarea>
  </div>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reporting-to-multiple-output-files">Reporting to multiple output files<a class="anchor-link" href="#Reporting-to-multiple-output-files">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you have a large workflow with several steps or modules, it makes sense to write several reports and join them at last. For example, in the following example, an output file is specified for each <code>report</code> and a summary step is used at the end to collect and process them.</p>

</div>
</div>
</div><div class="cell border-box-sizing code_cell rendered lan_SoS">
   
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div><div class="inner_cell" style="min-height: 38.44285718em;">
  <div class="input_area cm-s-ipython">
   <textarea rows="26" class="sos-source" name="SoS">%sandbox --dir ~/tmp
%preview summary.html
[10]
output: 'a.jpg'
R: expand=True
    jpeg({_output:r})
    cars <- c(1, 3, 6, 4, 9)
    barplot(cars)

report: output='figure.md', expand=True
    * Figure
    ![figure]({output})    

[20]
output: 'a.txt'
counts = 100
run: expand=True
    echo "{counts}" > a.txt

report: output='result.md', expand=True
    * result
    {counts}

[100]
pandoc: input=['figure.md', 'result.md'], output='summary.html'
    Final report</textarea>
  </div>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You will notice that both <code>script</code> and <code>input</code> are specified to action <code>pandoc</code>. In this case the <code>script</code> is put before the content of each <code>input</code> files, making it a perfect place to write headers and summaries.</p>

</div>
</div>
</div>
    </div>
  </div>
</body>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/codemirror.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/python/python.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/r/r.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/octave/octave.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/ruby/ruby.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/sas/sas.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/javascript/javascript.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/shell/shell.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/julia/julia.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.38.0/mode/markdown/markdown.js"></script>
	  <script src="../../js/sos-mode.js"> </script>
      <script>
		   function highlight_cells(cells, i, interval) {
			  setTimeout(function() {
				var editor = CodeMirror.fromTextArea(cells[i], {
		           lineNumbers: false,
				   styleActiveLine: true,
		           matchBrackets: true,
				   readOnly: true,
		           mode: 'sos',
				   base_mode: cells[i].name,
		         });
				$(cells[i]).parent().prepend("<select class='cell-kernel-selector'><option>" 
					+ cells[i].name + "</option></select>");
		      if (i < cells.length)
			    highlight_cells(cells, i + 1, interval);
			}, interval);
		  }

	      highlight_cells(document.getElementsByClassName("sos-source"), 0, 10);
      </script>



 


</html>
